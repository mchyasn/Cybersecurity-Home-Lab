# Word drops Ursnif through MSHTA.exe

Word: d2d0f8c60a4fa96827377311d5b2672a.doc.bin  
PCAP: .pcap  
Dropped HTML file: 

* See the [README](https://github.com/jstrosch/malware-samples) for information about the archive password.  

Analysis source: Cuckoo 2.0.7  
[Any.Run](https://app.any.run/tasks/cad33673-7229-4c13-be0f-dc442d165da4)  
Date: 03/27/2020  

Word document attempts to drop Ursnif as DLL and execute via regsvr32

## Process Activity

![Process Activity](https://user-images.githubusercontent.com/1920756/77800309-80403500-7044-11ea-8dca-e1b26339cdd3.png)

Process activity from the Word document, which copies MSHTA.exe to C:\ProgramData\Microsof.com before dropping index.html and executing it. HTML file is responsible for downloading DLL payload and executing via regsvr32.exe.

## Macros

![macros](https://user-images.githubusercontent.com/1920756/77800599-1ffdc300-7045-11ea-8476-785aa9ced198.png)

Deobfuscated macro code reveals the use of VBA.FileCopy to copy MSHTA.exe to new location, then drop and execute index.html file to download trojan.

## Network Activity

![Malware Check-In](https://user-images.githubusercontent.com/1920756/77800312-81716200-7044-11ea-8b35-b0695302ccb3.png)

Single HTTP request for the payload, unfortunately was a 404 at the time.

## Suricata Alerts

![Suricata Alerts](https://user-images.githubusercontent.com/1920756/77800314-8209f880-7044-11ea-9910-f56d94f261f0.png)  

Partial alerts generated by Any.Run